<?xml version="1.0" encoding="utf-8"?>
<!--
  File: wizard/wiz_move_splitter_view.xml
  Module: ons_autosplit_picking

  Created by cyp@open-net.ch

  Copyright (c) 2013 Open-Net Ltd. All rights reserved.
-->
<openerp>
<data>

    <!-- 
            The IN move splitter wizard
    -->
    <record model="ir.ui.view" id="ons_wiz_in_move_splitter">
        <field name="name">Open-Net Wizards: IN move splitter</field>
        <field name="model">ons.wiz.in_move_splitter</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Split an entering stock move" version="7.0">
            	<group>
                    <field name="move_id" on_change="on_change_move(move_id)" required="1"/>
                </group>
                <field name="product_id" colspan="4" invisible="1"/>
                <field name="onsp_stk_split_move_by_file" colspan="4" invisible="1"/>
                <field name="nb_moves" colspan="4" invisible="1"/>
				<group col="4" colspan="4" attrs="{'invisible':[('onsp_stk_split_move_by_file','=',True)]}">
                    <label string="Available serial numbers" colspan="2"/>
                    <newline/>
                	<field name="prodlot_ids" colspan="4" nolabel="1" context="{'default_product_id':product_id}"/>
                </group>
				<group col="4" colspan="4" attrs="{'invisible':[('onsp_stk_split_move_by_file','=',False)]}">
                    <group>
                        <field name="mv_split_fname" on_change="on_change_mv_split_fname(mv_split_fname, delimiter, nb_moves)" colspan="2"/>
        				<group col="2" colspan="2">
                            <label string="First column: the serial numbers" colspan="2"/>
                            <label string="Second column: the packaging, the others are ignored" colspan="3"/>
                            <label string="The other columns will be ignored" colspan="2"/>
                        </group>
                    </group>
                    <group>
                    	<field name="delimiter"/>
                        <field name="line_count" readonly="1"/>
                    </group>
                </group>
                <field name="prodlot_ids" attrs="{'invisible':[('prodlot_ids','=',False)]}"/>
                <separator string="" colspan="4" />
				<group col="14" colspan="4">
                    <label string="" colspan="10"/>
					<button special="cancel" string="Cancel" icon="gtk-cancel" colspan="2"/>
					<button name="do_split" string="Split" type="object" icon="gtk-ok" colspan="2"/>
				</group>
            </form>
        </field>
    </record>

    <!-- 
            The access to the IN move splitter wizard
    -->
	<act_window id="ons_act_in_move_splitter"
		name="Split an entering stock move"
		res_model="ons.wiz.in_move_splitter" 
		view_mode="form" 
		target="new" 
		view_type="form" />

    <!-- 
            The button to access the move splitter wizard in:
                the IN pickings
    -->
    <record model="ir.ui.view" id="ons_view_picking_in_form_inh01">
        <field name="name">ons.view.picking.in.form.inh01</field>
        <field name="model">stock.picking.in</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="stock.view_picking_in_form"/>
        <field name="arch" type="xml">
            <xpath expr="/form/header//button[@name='button_cancel']" position="after">
                <button name="%(ons_act_in_move_splitter)d" string="Split a stock move" states="draft" type="action" groups="base.group_user"/>
                <button name="%(ons_act_in_move_splitter)d" string="Split a stock move" states="assigned,confirmed" type="action" groups="base.group_user" class="oe_highlight"/>
            </xpath>
        </field>
    </record>

    <!-- 
            The INT/OUT move splitter wizard
    -->
    <record model="ir.ui.view" id="ons_wiz_int_out_move_splitter">
        <field name="name">Open-Net Wizards: INT/OUT move splitter</field>
        <field name="model">ons.wiz.int_out_move_splitter</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Split a non-entering stock move" version="7.0">
                <notebook>
                    <page string="Infos">
                    	<group>
                            <field name="move_id" on_change="on_change_move(move_id)" required="1"/>
                        </group>
                        <field name="product_id" colspan="4" invisible="1"/>
                        <field name="onsp_stk_split_move_by_file" colspan="4" invisible="1"/>
                        <field name="nb_moves" colspan="4" invisible="1"/>
        				<group col="4" colspan="4" attrs="{'invisible':[('onsp_stk_split_move_by_file','=',False)]}">
                            <group>
                                <field name="mv_split_fname" on_change="on_change_mv_split_fname(mv_split_fname, delimiter, move_id, nb_moves)" colspan="2"/>
                				<group col="2" colspan="2">
                                    <label string="First column: the packaging" colspan="2"/>
                                    <label string="The second: the serial numbers (empty=all of the packaging), the others are ignored" colspan="2"/>
                                    <label string="The other columns will be ignored" colspan="2"/>
                                </group>
                            </group>
                            <group>
                            	<field name="delimiter"/>
                                <field name="line_count" readonly="1"/>
                            </group>
                        </group>
                        <separator string="" colspan="4" />
        				<group col="14" colspan="4">
                            <label string="" colspan="10"/>
        					<button special="cancel" string="Cancel" icon="gtk-cancel" colspan="2"/>
        					<button name="do_split" string="Split" type="object" icon="gtk-ok" colspan="2"/>
        				</group>
                    </page>
                    <page string="Tracks/Serial" attrs="{'invisible':[('move_ids','=',False)]}">
                        <field name="move_ids" domain="[('product_id','=',product_id),('state','=','done')]" move="tree">
                            <tree string=" " create="false">
                                <field name="product_id"/>
                                <field name="product_qty"/>
                                <field name="product_uom"  string="Unit of Measure" groups="product.group_uom"/>
                                <field name="prodlot_id"  groups="stock.group_production_lot"/>
                                <field name="tracking_id" groups="stock.group_tracking_lot"/>
                                <field name="state" invisible="1"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
            </form>
        </field>
    </record>

    <!-- 
            The access to the INT/OUT move splitter wizard
    -->
	<act_window id="ons_act_int_out_move_splitter"
		name="Split a non-entering entering stock move"
		res_model="ons.wiz.int_out_move_splitter" 
		view_mode="form" 
		target="new" 
		view_type="form" />

    <!-- 
            The button to access the move splitter wizard in:
                the OUT pickings
    -->
    <record model="ir.ui.view" id="ons_view_picking_out_form_inh01">
        <field name="name">ons.view.picking.out.form.inh01</field>
        <field name="model">stock.picking.out</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="stock.view_picking_out_form"/>
        <field name="arch" type="xml">
            <xpath expr="/form/header//button[@name='button_cancel']" position="after">
                <button name="%(ons_act_int_out_move_splitter)d" string="Split a stock move" states="draft" type="action" groups="base.group_user"/>
                <button name="%(ons_act_int_out_move_splitter)d" string="Split a stock move" states="assigned,confirmed" type="action" groups="base.group_user" class="oe_highlight"/>
            </xpath>
        </field>
    </record>

    <!-- 
            The button to access the move splitter wizard in:
                the internal pickings
    -->
    <record model="ir.ui.view" id="ons_view_picking_intern_form_inh01">
        <field name="name">ons.view.picking.intern.form.inh01</field>
        <field name="model">stock.picking</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <xpath expr="/form/header//button[@name='button_cancel']" position="after">
                <button name="%(ons_act_int_out_move_splitter)d" string="Split a stock move" states="draft" type="action" groups="base.group_user"/>
                <button name="%(ons_act_int_out_move_splitter)d" string="Split a stock move" states="assigned,confirmed" type="action" groups="base.group_user" class="oe_highlight"/>
            </xpath>
        </field>
    </record>

</data>
</openerp>
