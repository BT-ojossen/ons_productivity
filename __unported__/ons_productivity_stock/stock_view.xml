<?xml version="1.0" encoding="utf-8"?>
<!--
  File: stock_view.xml
  Module: ons_productivity_stock

  Created by cyp@open-net.ch

  Copyright (c) 2013 Open-Net Ltd. All rights reserved.
-->
<openerp>
<data>

        <!--
            Complements to partner's form: links to IN and OUT pickings
        -->
        <act_window
            domain="[('partner_id','=',[active_id]),('type','=','out')]"
            id="ons_act_relate_out_picking"
            name="Related Out Pickings"
            res_model="stock.picking"
            src_model="res.partner"/>

        <act_window
            domain="[('partner_id','=',[active_id]),('type','=','in')]"
            id="ons_act_relate_in_picking"
            name="Related In Pickings"
            res_model="stock.picking"
            src_model="res.partner"/>

        <!--
            Complement to the picking out
        -->
        <record model="ir.ui.view" id="ons_view_move_picking_tree">
            <field name="name">stock.move.tree.ons</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_picking_tree"/>
            <field name="arch" type="xml">
                <field name="state" position="before">
                      <button name="split_move_by" string="Split by 1" type="object"  icon="gtk-justify-fill" states="draft,assigned,confirmed"/>
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="onsp_picking_out_form_inh01">
            <field name="name">onsp.picking.out.form.inh01</field>
            <field name="model">stock.picking.out</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="priority" eval="17"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='move_lines']" position="replace">
                    <field name="move_lines" context="{'address_out_id': partner_id, 'form_view_ref':'stock.view_move_picking_form', 'tree_view_ref':'ons_view_move_picking_tree', 'picking_type': 'out'}"/>
                </xpath>
            </field>
        </record>

        <!--
            Move the "Stock moves" tab in the Serial Number form
            And add the current location
        -->
        <record model="ir.ui.view" id="ons_prodlot_stock_move_form_inh01">
            <field name="name">ons_prodlot.stock.move.form.inh01</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.view_production_lot_form"/>
            <field name="priority" eval="17"/>
            <field name="arch" type="xml">
                <page string="Revisions" position="replace"/>
            </field>
        </record>

        <record model="ir.ui.view" id="ons_prodlot_stock_move_form_inh02">
            <field name="name">ons_prodlot.stock.move.form.inh02</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.view_production_lot_form"/>
            <field name="priority" eval="18"/>
            <field name="arch" type="xml">
                <page string="Stock Moves" position="after">
                    <page string="Revisions">
                        <field name="revisions"/>
                    </page>
                </page>
                <field name="stock_available" position="after">
                    <field name="current_location_id"/>
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="ons_prodlot_stock_move_tree_inh01">
            <field name="name">ons_prodlot.stock.move.tree.inh01</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.view_production_lot_tree"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="current_location_id"/>
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="ons_prodlot_stock_move_search_inh01">
            <field name="name">ons_prodlot.stock.move.search.inh01</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.search_product_lot_filter"/>
            <field name="arch" type="xml">
                <filter string="Product" position="after">
                    <filter string="Current location" icon="terp-accessories-archiver" domain="[]" context="{'group_by':'current_location_id'}"/>
                </filter>
            </field>
        </record>

</data>
</openerp>
