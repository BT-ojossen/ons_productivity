<?xml version="1.0" encoding="utf-8"?>
<!--
  File: views/sale_order_view.xml
  Module: ons_productivity_sale_purchase

  Created by cyp@open-net.ch

  Copyright (c) 2016-TODAY Open-Net Ltd. All rights reserved.
-->
<odoo>

        <!--
            More for the sale orders
        -->

        <record model="ir.ui.view" id="onsp_view_sale_order_form">
            <field name="name">Open Net Productivity: Purchase button in a sale form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="priority" eval="17"/>
            <field name="arch" type="xml">
               <xpath expr="//div[@name='button_box']" position="inside">
                   <field name="purchase_ids" invisible="1"/>
                   <button type="object"
                       name="action_view_purchases"
                       class="oe_stat_button"
                       icon="fa-shopping-cart"
                       attrs="{'invisible': [('purchase_count', '=', 0)]}" groups="base.group_user">
                       <field name="purchase_count" widget="statinfo" string="Purchases"/>
                   </button>
                </xpath>
            </field>
        </record>

        <record model="ir.actions.act_window" id="onsp_purchase_form_action">
            <field name="name">Purchase Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_mode">tree,kanban,form,pivot,graph,calendar</field>
            <field name="context">{'search_default_todo':1, 'show_purchase': True}</field>
            <field name="search_view_id" ref="purchase.view_purchase_order_filter"/>
        </record>

</odoo>
